<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Apache Flink 1.8-SNAPSHOT Documentation: Connect to External Systems</title>
    <link rel="shortcut icon" href="//ci.apache.org/projects/flink/flink-docs-master/page/favicon.ico" type="image/x-icon">
    <link rel="icon" href="//ci.apache.org/projects/flink/flink-docs-master/page/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="//ci.apache.org/projects/flink/flink-docs-stable/dev/table/connect.html">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-master/page/css/flink.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-master/page/css/syntax.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-master/page/css/codetabs.css">
    <link rel="stylesheet" href="//ci.apache.org/projects/flink/flink-docs-master/page/font-awesome/css/font-awesome.min.css">
    
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    

    <!-- Main content. -->
    <div class="container">
      
      <div class="row">
        <div class="col-lg-3" id="sidenavcol">
          







  
    
    
    
      
    
  

  
    
    
    
      
    
  

  
    
    
    
      













<div class="sidenav-logo">
  <p><a href="//ci.apache.org/projects/flink/flink-docs-master"><img class="bottom" alt="Apache Flink" src="//ci.apache.org/projects/flink/flink-docs-master/page/img/navbar-brand-logo.jpg"></a> v1.8-SNAPSHOT</p>
</div>
<ul id="sidenav">

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/"><i class="fa fa-home title" aria-hidden="true"></i> Home</a></li>
    
  

  
    

    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-2" data-toggle="collapse"><i class="fa fa-map-o title appetizer" aria-hidden="true"></i> Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-2"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/concepts/programming-model.html">Programming Model</a></li>
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/concepts/runtime.html">Distributed Runtime</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-6" data-toggle="collapse"><i class="fa fa-power-off title appetizer" aria-hidden="true"></i> Tutorials <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-6"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-7" data-toggle="collapse">API Tutorials <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-7"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/tutorials/datastream_api.html">DataStream API</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-10" data-toggle="collapse">Setup Tutorials <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-10"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/tutorials/local_setup.html">本地安装</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/tutorials/flink_on_windows.html">在Windows上运行Flink</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-15" data-toggle="collapse"><i class="fa fa-file-code-o title appetizer" aria-hidden="true"></i> Examples <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-15"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/examples/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/examples.html">批处理案例</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-18" data-toggle="collapse" class="active"><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</a><div class="collapse in" id="collapse-18"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-19" data-toggle="collapse">Project Build Setup <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-19"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/projectsetup/java_api_quickstart.html">Project Template for Java</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/projectsetup/scala_api_quickstart.html">Project Template for Scala</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/projectsetup/dependencies.html">Configuring Dependencies, Connectors, Libraries</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-24" data-toggle="collapse">Basic API Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-24"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/api_concepts.html">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/scala_api_extensions.html">Scala API Extensions</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/java_lambdas.html">Java Lambda Expressions</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-28" data-toggle="collapse">Streaming (DataStream API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-28"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/datastream_api.html">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-29" data-toggle="collapse">事件时间<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-29"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/event_time.html">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/event_timestamps_watermarks.html">生成时间戳/水印</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/event_timestamp_extractors.html">预定义的时间戳提取器/水印发射器</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-33" data-toggle="collapse">状态&容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-33"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/state.html">使用状态</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/broadcast_state.html">广播状态模式</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/checkpointing.html">检查点机制</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/queryable_state.html">可查询状态</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/state_backends.html">状态后端</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/schema_evolution.html">状态Schema演进</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/custom_serialization.html">自定义状态序列化</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-42" data-toggle="collapse">Operators <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-42"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/operators/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/operators/windows.html">窗口</a></li>
      
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/operators/joining.html">Joining</a></li>
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/operators/process_function.html">过程函数</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/operators/asyncio.html">异步I/O</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-48" data-toggle="collapse">连接器<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-48"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/guarantees.html">容错性保证</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/kafka.html">Kafka</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/cassandra.html">Cassandra</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/kinesis.html">Kinesis</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/elasticsearch.html">Elasticsearch</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/filesystem_sink.html">滚动文件接收器</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/streamfile_sink.html">流文件接收器</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/rabbitmq.html">RabbitMQ</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/nifi.html">NiFi</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/twitter.html">Twitter</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/side_output.html">旁侧输出</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/python.html">Python API</a></li>
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/testing.html">测试</a></li>
      
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/experimental.html">实验性功能</a></li>
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-65" data-toggle="collapse">Batch (DataSet API) <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-65"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/dataset_transformations.html">转换</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/fault_tolerance.html">容错</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/zip_elements_guide.html">Zipping Elements</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/iterations.html">迭代</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/python.html">Python API</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/connectors.html">连接器</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/batch/hadoop_compatibility.html">Hadoop兼容性</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/local_execution.html">本地执行</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/cluster_execution.html">集群执行</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-76" data-toggle="collapse" class="active">Table API & SQL</a><div class="collapse in" id="collapse-76"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/common.html">概念&通用API</a></li>
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-78" data-toggle="collapse">Streaming Concepts <i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-78"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/dynamic_tables.html">Dynamic Tables</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/time_attributes.html">Time Attributes</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/joins.html">Joins in Continuous Queries</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/temporal_tables.html">Temporal Tables</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/match_recognize.html">Detecting Patterns</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/streaming/query_configuration.html">Query Configuration</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/connect.html" class="active">连接外部系统</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/tableApi.html">Table API</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/sql.html">SQL</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/functions.html">内置函数</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/sourceSinks.html">用户自定义源&接收器</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/udfs.html">用户自定义函数</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/sqlClient.html">SQL客户端</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-94" data-toggle="collapse">数据类型&序列化<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-94"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/types_serialization.html">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/custom_serializers.html">自定义序列化器</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-97" data-toggle="collapse">管理执行<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-97"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/execution_configuration.html">执行配置</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/packaging.html">程序打包</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/parallel.html">并行执行</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/execution_plans.html">执行计划</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/restart_strategies.html">重启策略</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-104" data-toggle="collapse">类库<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-104"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/cep.html">事件处理(CEP)</a></li>
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-106" data-toggle="collapse">图计算: Gelly<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-106"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/graph_api.html">Graph API</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/iterative_graph_processing.html">Iterative Graph Processing</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/library_methods.html">Library Methods</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/graph_algorithms.html">Graph Algorithms</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/graph_generators.html">Graph Generators</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/gelly/bipartite_graph.html">Bipartite Graph</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-114" data-toggle="collapse">机器学习<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-114"><ul>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/">概览</a></li>
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/quickstart.html">Quickstart</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/contribution_guide.html">How to Contribute</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/cross_validation.html">Cross Validation</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/distance_metrics.html">Distance Metrics</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/knn.html">k-Nearest Neighbors Join</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/min_max_scaler.html">MinMax Scaler</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/multiple_linear_regression.html">Multiple Linear Regression</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/pipelines.html">Pipelines</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/polynomial_features.html">Polynomial Features</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/sos.html">Stochastic Outlier Selection</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/standard_scaler.html">Standard Scaler</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/als.html">ALS</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/libs/ml/svm.html">SVM using CoCoA</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/best_practices.html">Best Practices</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/migration.html">API迁移指南</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-133" data-toggle="collapse"><i class="fa fa-sliders title maindish" aria-hidden="true"></i>部署 & 运维<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-133"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-134" data-toggle="collapse">集群 & 部署<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-134"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/cluster_setup.html">Standalone Cluster</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/yarn_setup.html">YARN</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/mesos.html">Mesos</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/kubernetes.html">Kubernetes</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/docker.html">Docker</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/aws.html">AWS</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/gce_setup.html">Google Compute Engine</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/mapr_setup.html">MapR</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/hadoop.html">Hadoop Integration</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/deployment/oss.html">Aliyun OSS</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/jobmanager_high_availability.html">高可用(HA)</a></li>
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-147" data-toggle="collapse">状态&容错<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-147"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/state/checkpoints.html">Checkpoints</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/state/savepoints.html">Savepoints</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/state/state_backends.html">状态后端</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/state/large_state_tuning.html">Tuning Checkpoints and Large State</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/config.html">配置</a></li>
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/production_ready.html">生产准备清单</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/cli.html">命令行界面</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/scala_shell.html">Scala REPL(交互式解释器)</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/security-kerberos.html">Kerberos</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/security-ssl.html">SSL设置</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/filesystems.html">文件系统</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/ops/upgrading.html">升级应用程序和Flink版本</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-162" data-toggle="collapse"><i class="fa fa-bug title maindish" aria-hidden="true"></i>调试 & 监控<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-162"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/metrics.html">指标度量</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/logging.html">日志</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/historyserver.html">历史服务器</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/checkpoint_monitoring.html">监控检查点</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/back_pressure.html">监控背压</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/rest_api.html">监控REST API</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/debugging_event_time.html">调试Windows&Event Time</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/debugging_classloading.html">调试类加载</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/monitoring/application_profiling.html">应用程序分析</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    <hr class="section-break"></hr>

    
    
      
      
        
        
<li><a href="#collapse-173" data-toggle="collapse"><i class="fa fa-cogs title dessert" aria-hidden="true"></i>Flink开发<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-173"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/flinkDev/ide_setup.html">将Flink导入IDE</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/flinkDev/building.html">从源码构建Flink</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    

    

    
    
    

    

    
    
      
      
        
        
<li><a href="#collapse-177" data-toggle="collapse"><i class="fa fa-book title dessert" aria-hidden="true"></i>内幕<i class="fa fa-caret-down pull-right" aria-hidden="true" style="padding-top: 4px"></i></a><div class="collapse" id="collapse-177"><ul>
  
        
        
        

        
        
      
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/internals/components.html">Component Stack</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/internals/stream_checkpointing.html">Fault Tolerance for Data Streaming</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/internals/job_scheduling.html">Job作业和调度</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/internals/task_lifecycle.html">Task生命周期</a></li>
    
  

  
    

    

    
    
    

    

    
    
<li><a href="//ci.apache.org/projects/flink/flink-docs-master/internals/filesystems.html">文件系统</a></li>
    
  

  
    
      
      
</li></ul></div>
      
      
    
  

  
    
      
  <li class="divider"></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/api/java"><i class="fa fa-external-link title" aria-hidden="true"></i> Javadocs</a></li>
  <li><a href="//ci.apache.org/projects/flink/flink-docs-master/api/scala/index.html#org.apache.flink.api.scala.package"><i class="fa fa-external-link title" aria-hidden="true"></i> Scaladocs</a></li>
  <li><a href="http://flink.apache.org"><i class="fa fa-external-link title" aria-hidden="true"></i> Project Page</a></li>
</ul>

<div class="sidenav-search-box">
  <form class="navbar-form" role="search" action="//ci.apache.org/projects/flink/flink-docs-master/search-results.html">
    <div class="form-group">
      <input type="text" class="form-control" size="16px" name="q" placeholder="Search">
    </div>
    <button type="submit" class="btn btn-default">Go</button>
  </form>
</div>

<div class="sidenav-versions">
  <div class="dropdown">
    <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">Pick Docs Version
    <span class="caret"></span></button>
    <ul class="dropdown-menu">
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.7">v1.7</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.6">v1.6</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.5">v1.5</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.4">v1.4</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.3">v1.3</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.2">v1.2</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.1">v1.1</a></li>
      
      <li><a href="http://ci.apache.org/projects/flink/flink-docs-release-1.0">v1.0</a></li>
      
    </ul>
  </div>
</div>

        </div>
        <div class="col-lg-9 content" id="contentcol">
          

          





  
  
    
    
      
    
  

  
  
    
    
      
    
  

  
  
    
    
      



<ol class="breadcrumb">

  
  
    <li><i class="fa fa-code title maindish" aria-hidden="true"></i> Application Development</li>
  

  
  
    <li><a href="//ci.apache.org/projects/flink/flink-docs-master/dev/table/">Table API & SQL</a></li>
  

  
  
    <li class="active">连接外部系统</li>
  

</ol>

<h1>连接外部系统</h1>




<p>Flink’s Table API &amp; SQL programs can be connected to other external systems for reading and writing both batch and streaming tables. A table source provides access to data which is stored in external systems (such as a database, key-value store, message queue, or file system). A table sink emits a table to an external storage system. Depending on the type of source and sink, they support different formats such as CSV, Parquet, or ORC.</p>

<p>This page describes how to declare built-in table sources and/or table sinks and register them in Flink. After a source or sink has been registered, it can be accessed by Table API &amp; SQL statements.</p>

<p><span class="label label-danger">Attention</span> If you want to implement your own <em>custom</em> table source or sink, have a look at the <a href="sourceSinks.html">user-defined sources &amp; sinks page</a>.</p>

<ul id="markdown-toc">
  <li><a href="#dependencies" id="markdown-toc-dependencies">Dependencies</a></li>
  <li><a href="#overview" id="markdown-toc-overview">概览</a></li>
  <li><a href="#table-schema" id="markdown-toc-table-schema">Table Schema</a>    <ul>
      <li><a href="#rowtime-attributes" id="markdown-toc-rowtime-attributes">Rowtime Attributes</a></li>
      <li><a href="#type-strings" id="markdown-toc-type-strings">Type Strings</a></li>
    </ul>
  </li>
  <li><a href="#update-modes" id="markdown-toc-update-modes">Update Modes</a></li>
  <li><a href="#table-connectors" id="markdown-toc-table-connectors">Table Connectors</a>    <ul>
      <li><a href="#file-system-connector" id="markdown-toc-file-system-connector">File System Connector</a></li>
      <li><a href="#kafka-connector" id="markdown-toc-kafka-connector">Kafka Connector</a></li>
      <li><a href="#elasticsearch-connector" id="markdown-toc-elasticsearch-connector">Elasticsearch Connector</a></li>
    </ul>
  </li>
  <li><a href="#table-formats" id="markdown-toc-table-formats">Table Formats</a>    <ul>
      <li><a href="#csv-format" id="markdown-toc-csv-format">CSV Format</a></li>
      <li><a href="#json-format" id="markdown-toc-json-format">JSON Format</a></li>
      <li><a href="#apache-avro-format" id="markdown-toc-apache-avro-format">Apache Avro Format</a></li>
    </ul>
  </li>
  <li><a href="#further-tablesources-and-tablesinks" id="markdown-toc-further-tablesources-and-tablesinks">Further TableSources and TableSinks</a>    <ul>
      <li><a href="#orctablesource" id="markdown-toc-orctablesource">OrcTableSource</a></li>
      <li><a href="#csvtablesink" id="markdown-toc-csvtablesink">CsvTableSink</a></li>
      <li><a href="#jdbcappendtablesink" id="markdown-toc-jdbcappendtablesink">JDBCAppendTableSink</a></li>
      <li><a href="#cassandraappendtablesink" id="markdown-toc-cassandraappendtablesink">CassandraAppendTableSink</a></li>
    </ul>
  </li>
</ul>

<h2 id="dependencies">Dependencies</h2>

<p>The following tables list all available connectors and formats. Their mutual compatibility is tagged in the corresponding sections for <a href="connect.html#table-connectors">table connectors</a> and <a href="connect.html#table-formats">table formats</a>. The following tables provide dependency information for both projects using a build automation tool (such as Maven or SBT) and SQL Client with SQL JAR bundles.</p>

<p>These tables are only available for stable releases.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="overview">概览</h2>

<p>Beginning from Flink 1.6, the declaration of a connection to an external system is separated from the actual implementation.</p>

<p>Connections can be specified either</p>

<ul>
  <li><strong>programmatically</strong> using a <code class="highlighter-rouge">Descriptor</code> under <code class="highlighter-rouge">org.apache.flink.table.descriptors</code> for Table &amp; SQL API</li>
  <li>or <strong>declaratively</strong> via <a href="http://yaml.org/">YAML configuration files</a> for the SQL Client.</li>
</ul>

<p>This allows not only for better unification of APIs and SQL Client but also for better extensibility in case of <a href="sourceSinks.html">custom implementations</a> without changing the actual declaration.</p>

<p>Every declaration is similar to a SQL <code class="highlighter-rouge">CREATE TABLE</code> statement. One can define the name of the table, the schema of the table, a connector, and a data format upfront for connecting to an external system.</p>

<p>The <strong>connector</strong> describes the external system that stores the data of a table. Storage systems such as <a href="http://kafka.apache.org/">Apacha Kafka</a> or a regular file system can be declared here. The connector might already provide a fixed format with fields and schema.</p>

<p>Some systems support different <strong>data formats</strong>. For example, a table that is stored in Kafka or in files can encode its rows with CSV, JSON, or Avro. A database connector might need the table schema here. Whether or not a storage system requires the definition of a format, is documented for every <a href="connect.html#table-connectors">connector</a>. Different systems also require different <a href="connect.html#table-formats">types of formats</a> (e.g., column-oriented formats vs. row-oriented formats). The documentation states which format types and connectors are compatible.</p>

<p>The <strong>table schema</strong> defines the schema of a table that is exposed to SQL queries. It describes how a source maps the data format to the table schema and a sink vice versa. The schema has access to fields defined by the connector or format. It can use one or more fields for extracting or inserting <a href="streaming/time_attributes.html">time attributes</a>. If input fields have no deterministic field order, the schema clearly defines column names, their order, and origin.</p>

<p>The subsequent sections will cover each definition part (<a href="connect.html#table-connectors">connector</a>, <a href="connect.html#table-formats">format</a>, and <a href="connect.html#table-schema">schema</a>) in more detail. The following example shows how to pass them:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">tableEnvironment</span>
  <span class="o">.</span><span class="na">connect</span><span class="o">(...)</span>
  <span class="o">.</span><span class="na">withFormat</span><span class="o">(...)</span>
  <span class="o">.</span><span class="na">withSchema</span><span class="o">(...)</span>
  <span class="o">.</span><span class="na">inAppendMode</span><span class="o">()</span>
  <span class="o">.</span><span class="na">registerTableSource</span><span class="o">(</span><span class="s">"MyTable"</span><span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">name</span><span class="pi">:</span> <span class="s">MyTable</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">source</span>
<span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>
<span class="na">connector</span><span class="pi">:</span> <span class="s">...</span>
<span class="na">format</span><span class="pi">:</span> <span class="s">...</span>
<span class="na">schema</span><span class="pi">:</span> <span class="s">...</span></code></pre></figure>

  </div>
</div>

<p>The table’s type (<code class="highlighter-rouge">source</code>, <code class="highlighter-rouge">sink</code>, or <code class="highlighter-rouge">both</code>) determines how a table is registered. In case of table type <code class="highlighter-rouge">both</code>, both a table source and table sink are registered under the same name. Logically, this means that we can both read and write to such a table similarly to a table in a regular DBMS.</p>

<p>For streaming queries, an <a href="connect.html#update-mode">update mode</a> declares how to communicate between a dynamic table and the storage system for continuous queries.</p>

<p>The following code shows a full example of how to connect to Kafka for reading Avro records.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">tableEnvironment</span>
  <span class="c1">// declare the external system to connect to</span>
  <span class="o">.</span><span class="na">connect</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">Kafka</span><span class="o">()</span>
      <span class="o">.</span><span class="na">version</span><span class="o">(</span><span class="s">"0.10"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">topic</span><span class="o">(</span><span class="s">"test-input"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">startFromEarliest</span><span class="o">()</span>
      <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"zookeeper.connect"</span><span class="o">,</span> <span class="s">"localhost:2181"</span><span class="o">)</span>
      <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"bootstrap.servers"</span><span class="o">,</span> <span class="s">"localhost:9092"</span><span class="o">)</span>
  <span class="o">)</span>

  <span class="c1">// declare a format for this system</span>
  <span class="o">.</span><span class="na">withFormat</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">Avro</span><span class="o">()</span>
      <span class="o">.</span><span class="na">avroSchema</span><span class="o">(</span>
        <span class="s">"{"</span> <span class="o">+</span>
        <span class="s">"  \"namespace\": \"org.myorganization\","</span> <span class="o">+</span>
        <span class="s">"  \"type\": \"record\","</span> <span class="o">+</span>
        <span class="s">"  \"name\": \"UserMessage\","</span> <span class="o">+</span>
        <span class="s">"    \"fields\": ["</span> <span class="o">+</span>
        <span class="s">"      {\"name\": \"timestamp\", \"type\": \"string\"},"</span> <span class="o">+</span>
        <span class="s">"      {\"name\": \"user\", \"type\": \"long\"},"</span> <span class="o">+</span>
        <span class="s">"      {\"name\": \"message\", \"type\": [\"string\", \"null\"]}"</span> <span class="o">+</span>
        <span class="s">"    ]"</span> <span class="o">+</span>
        <span class="s">"}"</span>
      <span class="o">)</span>
  <span class="o">)</span>

  <span class="c1">// declare the schema of the table</span>
  <span class="o">.</span><span class="na">withSchema</span><span class="o">(</span>
    <span class="k">new</span> <span class="nf">Schema</span><span class="o">()</span>
      <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"rowtime"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">SQL_TIMESTAMP</span><span class="o">)</span>
        <span class="o">.</span><span class="na">rowtime</span><span class="o">(</span><span class="k">new</span> <span class="n">Rowtime</span><span class="o">()</span>
          <span class="o">.</span><span class="na">timestampsFromField</span><span class="o">(</span><span class="s">"timestamp"</span><span class="o">)</span>
          <span class="o">.</span><span class="na">watermarksPeriodicBounded</span><span class="o">(</span><span class="mi">60000</span><span class="o">)</span>
        <span class="o">)</span>
      <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"user"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">LONG</span><span class="o">)</span>
      <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"message"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
  <span class="o">)</span>

  <span class="c1">// specify the update-mode for streaming tables</span>
  <span class="o">.</span><span class="na">inAppendMode</span><span class="o">()</span>

  <span class="c1">// register as source, sink, or both and under a name</span>
  <span class="o">.</span><span class="na">registerTableSource</span><span class="o">(</span><span class="s">"MyUserTable"</span><span class="o">);</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyUserTable</span>      <span class="c1"># name the new table</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">source</span>           <span class="c1"># declare if the table should be "source", "sink", or "both"</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>    <span class="c1"># specify the update-mode for streaming tables</span>

    <span class="c1"># declare the external system to connect to</span>
    <span class="na">connector</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">kafka</span>
      <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.10"</span>
      <span class="na">topic</span><span class="pi">:</span> <span class="s">test-input</span>
      <span class="na">startup-mode</span><span class="pi">:</span> <span class="s">earliest-offset</span>
      <span class="na">properties</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">zookeeper.connect</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s">localhost:2181</span>
        <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">bootstrap.servers</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s">localhost:9092</span>

    <span class="c1"># declare a format for this system</span>
    <span class="na">format</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">avro</span>
      <span class="na">avro-schema</span><span class="pi">:</span> <span class="pi">&gt;</span>
        <span class="no">{</span>
          <span class="no">"namespace": "org.myorganization",</span>
          <span class="no">"type": "record",</span>
          <span class="no">"name": "UserMessage",</span>
            <span class="no">"fields": [</span>
              <span class="no">{"name": "ts", "type": "string"},</span>
              <span class="no">{"name": "user", "type": "long"},</span>
              <span class="no">{"name": "message", "type": ["string", "null"]}</span>
            <span class="no">]</span>
        <span class="no">}</span>

    <span class="c1"># declare the schema of the table</span>
    <span class="na">schema</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">rowtime</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">TIMESTAMP</span>
        <span class="na">rowtime</span><span class="pi">:</span>
          <span class="na">timestamps</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">from-field</span>
            <span class="na">from</span><span class="pi">:</span> <span class="s">ts</span>
          <span class="na">watermarks</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">periodic-bounded</span>
            <span class="na">delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60000"</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">BIGINT</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">message</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">VARCHAR</span></code></pre></figure>

  </div>
</div>

<p>In both ways the desired connection properties are converted into normalized, string-based key-value pairs. So-called <a href="sourceSinks.html#define-a-tablefactory">table factories</a> create configured table sources, table sinks, and corresponding formats from the key-value pairs. All table factories that can be found via Java’s <a href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html">Service Provider Interfaces (SPI)</a> are taken into account when searching for exactly-one matching table factory.</p>

<p>If no factory can be found or multiple factories match for the given properties, an exception will be thrown with additional information about considered factories and supported properties.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="table-schema">Table Schema</h2>

<p>The table schema defines the names and types of columns similar to the column definitions of a SQL <code class="highlighter-rouge">CREATE TABLE</code> statement. In addition, one can specify how columns are mapped from and to fields of the format in which the table data is encoded. The origin of a field might be important if the name of the column should differ from the input/output format. For instance, a column <code class="highlighter-rouge">user_name</code> should reference the field <code class="highlighter-rouge">$$-user-name</code> from a JSON format. Additionally, the schema is needed to map types from an external system to Flink’s representation. In case of a table sink, it ensures that only data with valid schema is written to an external system.</p>

<p>The following example shows a simple schema without time attributes and one-to-one field mapping of input/output to table columns.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">withSchema</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Schema</span><span class="o">()</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField1"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">)</span>     <span class="c1">// required: specify the fields of the table (in this order)</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField2"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField3"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">BOOLEAN</span><span class="o">)</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">schema</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField1</span>    <span class="c1"># required: specify the fields of the table (in this order)</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">INT</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField2</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">VARCHAR</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField3</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">BOOLEAN</span></code></pre></figure>

  </div>
</div>

<p>For <em>each field</em>, the following properties can be declared in addition to the column’s name and type:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">withSchema</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Schema</span><span class="o">()</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField1"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">SQL_TIMESTAMP</span><span class="o">)</span>
      <span class="o">.</span><span class="na">proctime</span><span class="o">()</span>      <span class="c1">// optional: declares this field as a processing-time attribute</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField2"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">SQL_TIMESTAMP</span><span class="o">)</span>
      <span class="o">.</span><span class="na">rowtime</span><span class="o">(...)</span>    <span class="c1">// optional: declares this field as a event-time attribute</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"MyField3"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">BOOLEAN</span><span class="o">)</span>
      <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="s">"mf3"</span><span class="o">)</span>     <span class="c1">// optional: original field in the input that is referenced/aliased by this field</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">schema</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField1</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">TIMESTAMP</span>
    <span class="na">proctime</span><span class="pi">:</span> <span class="no">true</span>    <span class="c1"># optional: boolean flag whether this field should be a processing-time attribute</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField2</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">TIMESTAMP</span>
    <span class="na">rowtime</span><span class="pi">:</span> <span class="s">...</span>      <span class="c1"># optional: wether this field should be a event-time attribute</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">MyField3</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">BOOLEAN</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s">mf3</span>         <span class="c1"># optional: original field in the input that is referenced/aliased by this field</span></code></pre></figure>

  </div>
</div>

<p>Time attributes are essential when working with unbounded streaming tables. Therefore both processing-time and event-time (also known as “rowtime”) attributes can be defined as part of the schema.</p>

<p>For more information about time handling in Flink and especially event-time, we recommend the general <a href="streaming/time_attributes.html">event-time section</a>.</p>

<h3 id="rowtime-attributes">Rowtime Attributes</h3>

<p>In order to control the event-time behavior for tables, Flink provides predefined timestamp extractors and watermark strategies.</p>

<p>The following timestamp extractors are supported:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Converts an existing LONG or SQL_TIMESTAMP field in the input into the rowtime attribute.</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">timestampsFromField</span><span class="o">(</span><span class="s">"ts_field"</span><span class="o">)</span>    <span class="c1">// required: original field name in the input</span>
<span class="o">)</span>

<span class="c1">// Converts the assigned timestamps from a DataStream API record into the rowtime attribute</span>
<span class="c1">// and thus preserves the assigned timestamps from the source.</span>
<span class="c1">// This requires a source that assigns timestamps (e.g., Kafka 0.10+).</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">timestampsFromSource</span><span class="o">()</span>
<span class="o">)</span>

<span class="c1">// Sets a custom timestamp extractor to be used for the rowtime attribute.</span>
<span class="c1">// The extractor must extend `org.apache.flink.table.sources.tsextractors.TimestampExtractor`.</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">timestampsFromExtractor</span><span class="o">(...)</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="c1"># Converts an existing BIGINT or TIMESTAMP field in the input into the rowtime attribute.</span>
<span class="na">rowtime</span><span class="pi">:</span>
  <span class="na">timestamps</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">from-field</span>
    <span class="na">from</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ts_field"</span>                 <span class="c1"># required: original field name in the input</span>

<span class="c1"># Converts the assigned timestamps from a DataStream API record into the rowtime attribute</span>
<span class="c1"># and thus preserves the assigned timestamps from the source.</span>
<span class="na">rowtime</span><span class="pi">:</span>
  <span class="na">timestamps</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">from-source</span></code></pre></figure>

  </div>
</div>

<p>The following watermark strategies are supported:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// Sets a watermark strategy for ascending rowtime attributes. Emits a watermark of the maximum</span>
<span class="c1">// observed timestamp so far minus 1. Rows that have a timestamp equal to the max timestamp</span>
<span class="c1">// are not late.</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">watermarksPeriodicAscending</span><span class="o">()</span>
<span class="o">)</span>

<span class="c1">// Sets a built-in watermark strategy for rowtime attributes which are out-of-order by a bounded time interval.</span>
<span class="c1">// Emits watermarks which are the maximum observed timestamp minus the specified delay.</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">watermarksPeriodicBounded</span><span class="o">(</span><span class="mi">2000</span><span class="o">)</span>    <span class="c1">// delay in milliseconds</span>
<span class="o">)</span>

<span class="c1">// Sets a built-in watermark strategy which indicates the watermarks should be preserved from the</span>
<span class="c1">// underlying DataStream API and thus preserves the assigned watermarks from the source.</span>
<span class="o">.</span><span class="na">rowtime</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Rowtime</span><span class="o">()</span>
    <span class="o">.</span><span class="na">watermarksFromSource</span><span class="o">()</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="c1"># Sets a watermark strategy for ascending rowtime attributes. Emits a watermark of the maximum</span>
<span class="c1"># observed timestamp so far minus 1. Rows that have a timestamp equal to the max timestamp</span>
<span class="c1"># are not late.</span>
<span class="na">rowtime</span><span class="pi">:</span>
  <span class="na">watermarks</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">periodic-ascending</span>

<span class="c1"># Sets a built-in watermark strategy for rowtime attributes which are out-of-order by a bounded time interval.</span>
<span class="c1"># Emits watermarks which are the maximum observed timestamp minus the specified delay.</span>
<span class="na">rowtime</span><span class="pi">:</span>
  <span class="na">watermarks</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">periodic-bounded</span>
    <span class="na">delay</span><span class="pi">:</span> <span class="s">...</span>                <span class="c1"># required: delay in milliseconds</span>

<span class="c1"># Sets a built-in watermark strategy which indicates the watermarks should be preserved from the</span>
<span class="c1"># underlying DataStream API and thus preserves the assigned watermarks from the source.</span>
<span class="na">rowtime</span><span class="pi">:</span>
  <span class="na">watermarks</span><span class="pi">:</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">from-source</span></code></pre></figure>

  </div>
</div>

<p>Make sure to always declare both timestamps and watermarks. Watermarks are required for triggering time-based operations.</p>

<h3 id="type-strings">Type Strings</h3>

<p>Because type information is only available in a programming language, the following type strings are supported for being defined in a YAML file:</p>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="s">VARCHAR</span>
<span class="s">BOOLEAN</span>
<span class="s">TINYINT</span>
<span class="s">SMALLINT</span>
<span class="s">INT</span>
<span class="s">BIGINT</span>
<span class="s">FLOAT</span>
<span class="s">DOUBLE</span>
<span class="s">DECIMAL</span>
<span class="s">DATE</span>
<span class="s">TIME</span>
<span class="s">TIMESTAMP</span>
<span class="s">MAP&lt;fieldtype, fieldtype&gt;</span>        <span class="c1"># generic map; e.g. MAP&lt;VARCHAR, INT&gt; that is mapped to Flink's MapTypeInfo</span>
<span class="s">MULTISET&lt;fieldtype&gt;</span>              <span class="c1"># multiset; e.g. MULTISET&lt;VARCHAR&gt; that is mapped to Flink's MultisetTypeInfo</span>
<span class="s">PRIMITIVE_ARRAY&lt;fieldtype&gt;</span>       <span class="c1"># primitive array; e.g. PRIMITIVE_ARRAY&lt;INT&gt; that is mapped to Flink's PrimitiveArrayTypeInfo</span>
<span class="s">OBJECT_ARRAY&lt;fieldtype&gt;</span>          <span class="c1"># object array; e.g. OBJECT_ARRAY&lt;POJO(org.mycompany.MyPojoClass)&gt; that is mapped to</span>
                                 <span class="c1">#   Flink's ObjectArrayTypeInfo</span>
<span class="s">ROW&lt;fieldtype, ...&gt;</span>              <span class="c1"># unnamed row; e.g. ROW&lt;VARCHAR, INT&gt; that is mapped to Flink's RowTypeInfo</span>
                                 <span class="c1">#   with indexed fields names f0, f1, ...</span>
<span class="s">ROW&lt;fieldname fieldtype, ...&gt;</span>    <span class="c1"># named row; e.g., ROW&lt;myField VARCHAR, myOtherField INT&gt; that</span>
                                 <span class="c1">#   is mapped to Flink's RowTypeInfo</span>
<span class="s">POJO&lt;class&gt;</span>                      <span class="c1"># e.g., POJO&lt;org.mycompany.MyPojoClass&gt; that is mapped to Flink's PojoTypeInfo</span>
<span class="s">ANY&lt;class&gt;</span>                       <span class="c1"># e.g., ANY&lt;org.mycompany.MyClass&gt; that is mapped to Flink's GenericTypeInfo</span>
<span class="s">ANY&lt;class, serialized&gt;</span>           <span class="c1"># used for type information that is not supported by Flink's Table &amp; SQL API</span></code></pre></figure>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="update-modes">Update Modes</h2>

<p>For streaming queries, it is required to declare how to perform the <a href="streaming/dynamic_tables.html#continuous-queries">conversion between a dynamic table and an external connector</a>. The <em>update mode</em> specifies which kind of messages should be exchanged with the external system:</p>

<p><strong>Append Mode:</strong> In append mode, a dynamic table and an external connector only exchange INSERT messages.</p>

<p><strong>Retract Mode:</strong> In retract mode, a dynamic table and an external connector exchange ADD and RETRACT messages. An INSERT change is encoded as an ADD message, a DELETE change as a RETRACT message, and an UPDATE change as a RETRACT message for the updated (previous) row and an ADD message for the updating (new) row. In this mode, a key must not be defined as opposed to upsert mode. However, every update consists of two messages which is less efficient.</p>

<p><strong>Upsert Mode:</strong> In upsert mode, a dynamic table and an external connector exchange UPSERT and DELETE messages. This mode requires a (possibly composite) unique key by which updates can be propagated. The external connector needs to be aware of the unique key attribute in order to apply messages correctly. INSERT and UPDATE changes are encoded as UPSERT messages. DELETE changes as DELETE messages. The main difference to a retract stream is that UPDATE changes are encoded with a single message and are therefore more efficient.</p>

<p><span class="label label-danger">Attention</span> The documentation of each connector states which update modes are supported.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">connect</span><span class="o">(...)</span>
  <span class="o">.</span><span class="na">inAppendMode</span><span class="o">()</span>    <span class="c1">// otherwise: inUpsertMode() or inRetractMode()</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">tables</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">...</span>
    <span class="na">update-mode</span><span class="pi">:</span> <span class="s">append</span>    <span class="c1"># otherwise: "retract" or "upsert"</span></code></pre></figure>

  </div>
</div>

<p>See also the <a href="streaming/dynamic_tables.html#continuous-queries">general streaming concepts documentation</a> for more information.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="table-connectors">Table Connectors</h2>

<p>Flink provides a set of connectors for connecting to external systems.</p>

<p>Please note that not all connectors are available in both batch and streaming yet. Furthermore, not every streaming connector supports every streaming mode. Therefore, each connector is tagged accordingly. A format tag indicates that the connector requires a certain type of format.</p>

<h3 id="file-system-connector">File System Connector</h3>

<p><span class="label label-primary">Source: Batch</span>
<span class="label label-primary">Source: Streaming Append Mode</span>
<span class="label label-primary">Sink: Batch</span>
<span class="label label-primary">Sink: Streaming Append Mode</span>
<span class="label label-info">Format: CSV-only</span></p>

<p>The file system connector allows for reading and writing from a local or distributed filesystem. A filesystem can be defined as:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">connect</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">FileSystem</span><span class="o">()</span>
    <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"file:///path/to/whatever"</span><span class="o">)</span>    <span class="c1">// required: path to a file or directory</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">connector</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">filesystem</span>
  <span class="na">path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">file:///path/to/whatever"</span>    <span class="c1"># required: path to a file or directory</span></code></pre></figure>

  </div>
</div>

<p>The file system connector itself is included in Flink and does not require an additional dependency. A corresponding format needs to be specified for reading and writing rows from and to a file system.</p>

<p><span class="label label-danger">Attention</span> Make sure to include <a href="//ci.apache.org/projects/flink/flink-docs-master/ops/filesystems.html">Flink File System specific dependencies</a>.</p>

<p><span class="label label-danger">Attention</span> File system sources and sinks for streaming are only experimental. In the future, we will support actual streaming use cases, i.e., directory monitoring and bucket output.</p>

<h3 id="kafka-connector">Kafka Connector</h3>

<p><span class="label label-primary">Source: Streaming Append Mode</span>
<span class="label label-primary">Sink: Streaming Append Mode</span>
<span class="label label-info">Format: Serialization Schema</span>
<span class="label label-info">Format: Deserialization Schema</span></p>

<p>The Kafka connector allows for reading and writing from and to an Apache Kafka topic. It can be defined as follows:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">connect</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Kafka</span><span class="o">()</span>
    <span class="o">.</span><span class="na">version</span><span class="o">(</span><span class="s">"0.11"</span><span class="o">)</span>    <span class="c1">// required: valid connector versions are</span>
                        <span class="c1">//   "0.8", "0.9", "0.10", "0.11", and "universal"</span>
    <span class="o">.</span><span class="na">topic</span><span class="o">(</span><span class="s">"..."</span><span class="o">)</span>       <span class="c1">// required: topic name from which the table is read</span>

    <span class="c1">// optional: connector specific properties</span>
    <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"zookeeper.connect"</span><span class="o">,</span> <span class="s">"localhost:2181"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"bootstrap.servers"</span><span class="o">,</span> <span class="s">"localhost:9092"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">property</span><span class="o">(</span><span class="s">"group.id"</span><span class="o">,</span> <span class="s">"testGroup"</span><span class="o">)</span>

    <span class="c1">// optional: select a startup mode for Kafka offsets</span>
    <span class="o">.</span><span class="na">startFromEarliest</span><span class="o">()</span>
    <span class="o">.</span><span class="na">startFromLatest</span><span class="o">()</span>
    <span class="o">.</span><span class="na">startFromSpecificOffsets</span><span class="o">(...)</span>

    <span class="c1">// optional: output partitioning from Flink's partitions into Kafka's partitions</span>
    <span class="o">.</span><span class="na">sinkPartitionerFixed</span><span class="o">()</span>         <span class="c1">// each Flink partition ends up in at-most one Kafka partition (default)</span>
    <span class="o">.</span><span class="na">sinkPartitionerRoundRobin</span><span class="o">()</span>    <span class="c1">// a Flink partition is distributed to Kafka partitions round-robin</span>
    <span class="o">.</span><span class="na">sinkPartitionerCustom</span><span class="o">(</span><span class="n">MyCustom</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>    <span class="c1">// use a custom FlinkKafkaPartitioner subclass</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">connector</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">kafka</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.11"</span>     <span class="c1"># required: valid connector versions are</span>
                      <span class="c1">#   "0.8", "0.9", "0.10", "0.11", and "universal"</span>
  <span class="na">topic</span><span class="pi">:</span> <span class="s">...</span>          <span class="c1"># required: topic name from which the table is read</span>

  <span class="na">properties</span><span class="pi">:</span>         <span class="c1"># optional: connector specific properties</span>
    <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">zookeeper.connect</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">localhost:2181</span>
    <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">bootstrap.servers</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">localhost:9092</span>
    <span class="pi">-</span> <span class="na">key</span><span class="pi">:</span> <span class="s">group.id</span>
      <span class="na">value</span><span class="pi">:</span> <span class="s">testGroup</span>

  <span class="na">startup-mode</span><span class="pi">:</span> <span class="s">...</span>   <span class="c1"># optional: valid modes are "earliest-offset", "latest-offset",</span>
                      <span class="c1"># "group-offsets", or "specific-offsets"</span>
  <span class="na">specific-offsets</span><span class="pi">:</span>   <span class="c1"># optional: used in case of startup mode with specific offsets</span>
    <span class="pi">-</span> <span class="na">partition</span><span class="pi">:</span> <span class="s">0</span>
      <span class="na">offset</span><span class="pi">:</span> <span class="s">42</span>
    <span class="pi">-</span> <span class="na">partition</span><span class="pi">:</span> <span class="s">1</span>
      <span class="na">offset</span><span class="pi">:</span> <span class="s">300</span>

  <span class="na">sink-partitioner</span><span class="pi">:</span> <span class="s">...</span>    <span class="c1"># optional: output partitioning from Flink's partitions into Kafka's partitions</span>
                           <span class="c1"># valid are "fixed" (each Flink partition ends up in at most one Kafka partition),</span>
                           <span class="c1"># "round-robin" (a Flink partition is distributed to Kafka partitions round-robin)</span>
                           <span class="c1"># "custom" (use a custom FlinkKafkaPartitioner subclass)</span>
  <span class="na">sink-partitioner-class</span><span class="pi">:</span> <span class="s">org.mycompany.MyPartitioner</span>  <span class="c1"># optional: used in case of sink partitioner custom</span></code></pre></figure>

  </div>
</div>

<p><strong>Specify the start reading position:</strong> By default, the Kafka source will start reading data from the committed group offsets in Zookeeper or Kafka brokers. You can specify other start positions, which correspond to the configurations in section <a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/kafka.html#kafka-consumers-start-position-configuration">Kafka Consumers Start Position Configuration</a>.</p>

<p><strong>Flink-Kafka Sink Partitioning:</strong> By default, a Kafka sink writes to at most as many partitions as its own parallelism (each parallel instance of the sink writes to exactly one partition). In order to distribute the writes to more partitions or control the routing of rows into partitions, a custom sink partitioner can be provided. The round-robin partitioner is useful to avoid an unbalanced partitioning. However, it will cause a lot of network connections between all the Flink instances and all the Kafka brokers.</p>

<p><strong>Consistency guarantees:</strong> By default, a Kafka sink ingests data with at-least-once guarantees into a Kafka topic if the query is executed with <a href="//ci.apache.org/projects/flink/flink-docs-master/dev/stream/state/checkpointing.html#enabling-and-configuring-checkpointing">checkpointing enabled</a>.</p>

<p><strong>Kafka 0.10+ Timestamps:</strong> Since Kafka 0.10, Kafka messages have a timestamp as metadata that specifies when the record was written into the Kafka topic. These timestamps can be used for a <a href="connect.html#defining-the-schema">rowtime attribute</a> by selecting <code class="highlighter-rouge">timestamps: from-source</code> in YAML and <code class="highlighter-rouge">timestampsFromSource()</code> in Java/Scala respectively.</p>

<p><strong>Kafka 0.11+ Versioning:</strong> Since Flink 1.7, the Kafka connector definition should be independent of a hard-coded Kafka version. Use the connector version <code class="highlighter-rouge">universal</code> as a wildcard for Flink’s Kafka connector that is compatible with all Kafka versions starting from 0.11.</p>

<p>Make sure to add the version-specific Kafka dependency. In addition, a corresponding format needs to be specified for reading and writing rows from and to Kafka.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="elasticsearch-connector">Elasticsearch Connector</h3>

<p><span class="label label-primary">Sink: Streaming Append Mode</span>
<span class="label label-primary">Sink: Streaming Upsert Mode</span>
<span class="label label-info">Format: JSON-only</span></p>

<p>The Elasticsearch connector allows for writing into an index of the Elasticsearch search engine.</p>

<p>The connector can operate in <a href="#update-modes">upsert mode</a> for exchanging UPSERT/DELETE messages with the external system using a <a href="./streaming/dynamic_tables.html#table-to-stream-conversion">key defined by the query</a>.</p>

<p>For append-only queries, the connector can also operate in <a href="#update-modes">append mode</a> for exchanging only INSERT messages with the external system. If no key is defined by the query, a key is automatically generated by Elasticsearch.</p>

<p>The connector can be defined as follows:</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">connect</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Elasticsearch</span><span class="o">()</span>
    <span class="o">.</span><span class="na">version</span><span class="o">(</span><span class="s">"6"</span><span class="o">)</span>                      <span class="c1">// required: valid connector versions are "6"</span>
    <span class="o">.</span><span class="na">host</span><span class="o">(</span><span class="s">"localhost"</span><span class="o">,</span> <span class="mi">9200</span><span class="o">,</span> <span class="s">"http"</span><span class="o">)</span>   <span class="c1">// required: one or more Elasticsearch hosts to connect to</span>
    <span class="o">.</span><span class="na">index</span><span class="o">(</span><span class="s">"MyUsers"</span><span class="o">)</span>                  <span class="c1">// required: Elasticsearch index</span>
    <span class="o">.</span><span class="na">documentType</span><span class="o">(</span><span class="s">"user"</span><span class="o">)</span>              <span class="c1">// required: Elasticsearch document type</span>

    <span class="o">.</span><span class="na">keyDelimiter</span><span class="o">(</span><span class="s">"$"</span><span class="o">)</span>        <span class="c1">// optional: delimiter for composite keys ("_" by default)</span>
                              <span class="c1">//   e.g., "$" would result in IDs "KEY1$KEY2$KEY3"</span>
    <span class="o">.</span><span class="na">keyNullLiteral</span><span class="o">(</span><span class="s">"n/a"</span><span class="o">)</span>    <span class="c1">// optional: representation for null fields in keys ("null" by default)</span>

    <span class="c1">// optional: failure handling strategy in case a request to Elasticsearch fails (fail by default)</span>
    <span class="o">.</span><span class="na">failureHandlerFail</span><span class="o">()</span>          <span class="c1">// optional: throws an exception if a request fails and causes a job failure</span>
    <span class="o">.</span><span class="na">failureHandlerIgnore</span><span class="o">()</span>        <span class="c1">//   or ignores failures and drops the request</span>
    <span class="o">.</span><span class="na">failureHandlerRetryRejected</span><span class="o">()</span> <span class="c1">//   or re-adds requests that have failed due to queue capacity saturation</span>
    <span class="o">.</span><span class="na">failureHandlerCustom</span><span class="o">(...)</span>     <span class="c1">//   or custom failure handling with a ActionRequestFailureHandler subclass</span>

    <span class="c1">// optional: configure how to buffer elements before sending them in bulk to the cluster for efficiency</span>
    <span class="o">.</span><span class="na">disableFlushOnCheckpoint</span><span class="o">()</span>    <span class="c1">// optional: disables flushing on checkpoint (see notes below!)</span>
    <span class="o">.</span><span class="na">bulkFlushMaxActions</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>       <span class="c1">// optional: maximum number of actions to buffer for each bulk request</span>
    <span class="o">.</span><span class="na">bulkFlushMaxSize</span><span class="o">(</span><span class="s">"42 mb"</span><span class="o">)</span>     <span class="c1">// optional: maximum size of buffered actions in bytes per bulk request</span>
                                   <span class="c1">//   (only MB granularity is supported)</span>
    <span class="o">.</span><span class="na">bulkFlushInterval</span><span class="o">(</span><span class="mi">60000L</span><span class="o">)</span>     <span class="c1">// optional: bulk flush interval (in milliseconds)</span>

    <span class="o">.</span><span class="na">bulkFlushBackoffConstant</span><span class="o">()</span>    <span class="c1">// optional: use a constant backoff type</span>
    <span class="o">.</span><span class="na">bulkFlushBackoffExponential</span><span class="o">()</span> <span class="c1">//   or use an exponential backoff type</span>
    <span class="o">.</span><span class="na">bulkFlushBackoffMaxRetries</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="c1">// optional: maximum number of retries</span>
    <span class="o">.</span><span class="na">bulkFlushBackoffDelay</span><span class="o">(</span><span class="mi">30000L</span><span class="o">)</span> <span class="c1">// optional: delay between each backoff attempt (in milliseconds)</span>

    <span class="c1">// optional: connection properties to be used during REST communication to Elasticsearch</span>
    <span class="o">.</span><span class="na">connectionMaxRetryTimeout</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>  <span class="c1">// optional: maximum timeout (in milliseconds) between retries</span>
    <span class="o">.</span><span class="na">connectionPathPrefix</span><span class="o">(</span><span class="s">"/v1"</span><span class="o">)</span>   <span class="c1">// optional: prefix string to be added to every REST communication</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">connector</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">elasticsearch</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s">6</span>                <span class="c1"># required: valid connector versions are "6"</span>
    <span class="na">hosts</span><span class="pi">:</span>                  <span class="c1"># required: one or more Elasticsearch hosts to connect to</span>
      <span class="pi">-</span> <span class="na">hostname</span><span class="pi">:</span> <span class="s2">"</span><span class="s">localhost"</span>
        <span class="na">port</span><span class="pi">:</span> <span class="s">9200</span>
        <span class="na">protocol</span><span class="pi">:</span> <span class="s2">"</span><span class="s">http"</span>
    <span class="na">index</span><span class="pi">:</span> <span class="s2">"</span><span class="s">MyUsers"</span>        <span class="c1"># required: Elasticsearch index</span>
    <span class="na">document-type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">user"</span>   <span class="c1"># required: Elasticsearch document type</span>

    <span class="na">key-delimiter</span><span class="pi">:</span> <span class="s2">"</span><span class="s">$"</span>      <span class="c1"># optional: delimiter for composite keys ("_" by default)</span>
                            <span class="c1">#   e.g., "$" would result in IDs "KEY1$KEY2$KEY3"</span>
    <span class="na">key-null-literal</span><span class="pi">:</span> <span class="s2">"</span><span class="s">n/a"</span> <span class="c1"># optional: representation for null fields in keys ("null" by default)</span>

    <span class="c1"># optional: failure handling strategy in case a request to Elasticsearch fails ("fail" by default)</span>
    <span class="na">failure-handler</span><span class="pi">:</span> <span class="s">...</span>    <span class="c1"># valid strategies are "fail" (throws an exception if a request fails and</span>
                            <span class="c1">#   thus causes a job failure), "ignore" (ignores failures and drops the request),</span>
                            <span class="c1">#   "retry-rejected" (re-adds requests that have failed due to queue capacity</span>
                            <span class="c1">#   saturation), or "custom" for failure handling with a</span>
                            <span class="c1">#   ActionRequestFailureHandler subclass</span>

    <span class="c1"># optional: configure how to buffer elements before sending them in bulk to the cluster for efficiency</span>
    <span class="na">flush-on-checkpoint</span><span class="pi">:</span> <span class="no">true</span>   <span class="c1"># optional: disables flushing on checkpoint (see notes below!) ("true" by default)</span>
    <span class="na">bulk-flush</span><span class="pi">:</span>
      <span class="na">max-actions</span><span class="pi">:</span> <span class="s">42</span>           <span class="c1"># optional: maximum number of actions to buffer for each bulk request</span>
      <span class="na">max-size</span><span class="pi">:</span> <span class="s">42 mb</span>           <span class="c1"># optional: maximum size of buffered actions in bytes per bulk request</span>
                                <span class="c1">#   (only MB granularity is supported)</span>
      <span class="na">interval</span><span class="pi">:</span> <span class="s">60000</span>           <span class="c1"># optional: bulk flush interval (in milliseconds)</span>
      <span class="na">back-off</span><span class="pi">:</span>                 <span class="c1"># optional: backoff strategy ("disabled" by default)</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">...</span>               <span class="c1">#   valid strategies are "disabled", "constant", or "exponential"</span>
        <span class="na">max-retries</span><span class="pi">:</span> <span class="s">3</span>          <span class="c1"># optional: maximum number of retries</span>
        <span class="na">delay</span><span class="pi">:</span> <span class="s">30000</span>            <span class="c1"># optional: delay between each backoff attempt (in milliseconds)</span>

    <span class="c1"># optional: connection properties to be used during REST communication to Elasticsearch</span>
    <span class="na">connection-max-retry-timeout</span><span class="pi">:</span> <span class="s">3</span>   <span class="c1"># optional: maximum timeout (in milliseconds) between retries</span>
    <span class="na">connection-path-prefix</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/v1"</span>     <span class="c1"># optional: prefix string to be added to every REST communication</span></code></pre></figure>

  </div>
</div>

<p><strong>Bulk flushing:</strong> For more information about characteristics of the optional flushing parameters see the <a href="//ci.apache.org/projects/flink/flink-docs-master/dev/connectors/elasticsearch.html">corresponding low-level documentation</a>.</p>

<p><strong>Disabling flushing on checkpoint:</strong> When disabled, a sink will not wait for all pending action requests to be acknowledged by Elasticsearch on checkpoints. Thus, a sink does NOT provide any strong guarantees for at-least-once delivery of action requests.</p>

<p><strong>Key extraction:</strong> Flink automatically extracts valid keys from a query. For example, a query <code class="highlighter-rouge">SELECT a, b, c FROM t GROUP BY a, b</code> defines a composite key of the fields <code class="highlighter-rouge">a</code> and <code class="highlighter-rouge">b</code>. The Elasticsearch connector generates a document ID string for every row by concatenating all key fields in the order defined in the query using a key delimiter. A custom representation of null literals for key fields can be defined.</p>

<p><span class="label label-danger">Attention</span> A JSON format defines how to encode documents for the external system, therefore, it must be added as a <a href="connect.html#formats">dependency</a>.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="table-formats">Table Formats</h2>

<p>Flink provides a set of table formats that can be used with table connectors.</p>

<p>A format tag indicates the format type for matching with a connector.</p>

<h3 id="csv-format">CSV Format</h3>

<p>The CSV format allows to read and write comma-separated rows.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">withFormat</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Csv</span><span class="o">()</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"field1"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">)</span>    <span class="c1">// required: ordered format fields</span>
    <span class="o">.</span><span class="na">field</span><span class="o">(</span><span class="s">"field2"</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">TIMESTAMP</span><span class="o">)</span>
    <span class="o">.</span><span class="na">fieldDelimiter</span><span class="o">(</span><span class="s">","</span><span class="o">)</span>              <span class="c1">// optional: string delimiter "," by default</span>
    <span class="o">.</span><span class="na">lineDelimiter</span><span class="o">(</span><span class="s">"\n"</span><span class="o">)</span>              <span class="c1">// optional: string delimiter "\n" by default</span>
    <span class="o">.</span><span class="na">quoteCharacter</span><span class="o">(</span><span class="sc">'"'</span><span class="o">)</span>              <span class="c1">// optional: single character for string values, empty by default</span>
    <span class="o">.</span><span class="na">commentPrefix</span><span class="o">(</span><span class="sc">'#'</span><span class="o">)</span>               <span class="c1">// optional: string to indicate comments, empty by default</span>
    <span class="o">.</span><span class="na">ignoreFirstLine</span><span class="o">()</span>                <span class="c1">// optional: ignore the first line, by default it is not skipped</span>
    <span class="o">.</span><span class="na">ignoreParseErrors</span><span class="o">()</span>              <span class="c1">// optional: skip records with parse error instead of failing by default</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">format</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">csv</span>
  <span class="na">fields</span><span class="pi">:</span>                    <span class="c1"># required: ordered format fields</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">field1</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">VARCHAR</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">field2</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">TIMESTAMP</span>
  <span class="na">field-delimiter</span><span class="pi">:</span> <span class="s2">"</span><span class="s">,"</span>       <span class="c1"># optional: string delimiter "," by default</span>
  <span class="na">line-delimiter</span><span class="pi">:</span> <span class="s2">"</span><span class="se">\n</span><span class="s">"</span>       <span class="c1"># optional: string delimiter "\n" by default</span>
  <span class="na">quote-character</span><span class="pi">:</span> <span class="s1">'</span><span class="s">"'</span>       <span class="c1"># optional: single character for string values, empty by default</span>
  <span class="na">comment-prefix</span><span class="pi">:</span> <span class="s1">'</span><span class="s">#'</span>        <span class="c1"># optional: string to indicate comments, empty by default</span>
  <span class="na">ignore-first-line</span><span class="pi">:</span> <span class="no">false</span>   <span class="c1"># optional: boolean flag to ignore the first line, by default it is not skipped</span>
  <span class="na">ignore-parse-errors</span><span class="pi">:</span> <span class="no">true</span>  <span class="c1"># optional: skip records with parse error instead of failing by default</span></code></pre></figure>

  </div>
</div>

<p>The CSV format is included in Flink and does not require additional dependencies.</p>

<p><span class="label label-danger">Attention</span> The CSV format for writing rows is limited at the moment. Only a custom field delimiter is supported as optional parameter.</p>

<h3 id="json-format">JSON Format</h3>

<p><span class="label label-info">Format: Serialization Schema</span>
<span class="label label-info">Format: Deserialization Schema</span></p>

<p>The JSON format allows to read and write JSON data that corresponds to a given format schema. The format schema can be defined either as a Flink type, as a JSON schema, or derived from the desired table schema. A Flink type enables a more SQL-like definition and mapping to the corresponding SQL data types. The JSON schema allows for more complex and nested structures.</p>

<p>If the format schema is equal to the table schema, the schema can also be automatically derived. This allows for defining schema information only once. The names, types, and field order of the format are determined by the table’s schema. Time attributes are ignored if their origin is not a field. A <code class="highlighter-rouge">from</code> definition in the table schema is interpreted as a field renaming in the format.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">withFormat</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Json</span><span class="o">()</span>
    <span class="o">.</span><span class="na">failOnMissingField</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>   <span class="c1">// optional: flag whether to fail if a field is missing or not, false by default</span>

    <span class="c1">// required: define the schema either by using type information which parses numbers to corresponding types</span>
    <span class="o">.</span><span class="na">schema</span><span class="o">(</span><span class="n">Type</span><span class="o">.</span><span class="na">ROW</span><span class="o">(...))</span>

    <span class="c1">// or by using a JSON schema which parses to DECIMAL and TIMESTAMP</span>
    <span class="o">.</span><span class="na">jsonSchema</span><span class="o">(</span>
      <span class="s">"{"</span> <span class="o">+</span>
      <span class="s">"  type: 'object',"</span> <span class="o">+</span>
      <span class="s">"  properties: {"</span> <span class="o">+</span>
      <span class="s">"    lon: {"</span> <span class="o">+</span>
      <span class="s">"      type: 'number'"</span> <span class="o">+</span>
      <span class="s">"    },"</span> <span class="o">+</span>
      <span class="s">"    rideTime: {"</span> <span class="o">+</span>
      <span class="s">"      type: 'string',"</span> <span class="o">+</span>
      <span class="s">"      format: 'date-time'"</span> <span class="o">+</span>
      <span class="s">"    }"</span> <span class="o">+</span>
      <span class="s">"  }"</span> <span class="o">+</span>
      <span class="s">"}"</span>
    <span class="o">)</span>

    <span class="c1">// or use the table's schema</span>
    <span class="o">.</span><span class="na">deriveSchema</span><span class="o">()</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">format</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">json</span>
  <span class="na">fail-on-missing-field</span><span class="pi">:</span> <span class="no">true</span>   <span class="c1"># optional: flag whether to fail if a field is missing or not, false by default</span>

  <span class="c1"># required: define the schema either by using a type string which parses numbers to corresponding types</span>
  <span class="na">schema</span><span class="pi">:</span> <span class="s2">"</span><span class="s">ROW(lon</span><span class="nv"> </span><span class="s">FLOAT,</span><span class="nv"> </span><span class="s">rideTime</span><span class="nv"> </span><span class="s">TIMESTAMP)"</span>

  <span class="c1"># or by using a JSON schema which parses to DECIMAL and TIMESTAMP</span>
  <span class="na">json-schema</span><span class="pi">:</span> <span class="pi">&gt;</span>
    <span class="no">{</span>
      <span class="no">type: 'object',</span>
      <span class="no">properties: {</span>
        <span class="no">lon: {</span>
          <span class="no">type: 'number'</span>
        <span class="no">},</span>
        <span class="no">rideTime: {</span>
          <span class="no">type: 'string',</span>
          <span class="no">format: 'date-time'</span>
        <span class="no">}</span>
      <span class="no">}</span>
    <span class="no">}</span>

  <span class="c1"># or use the table's schema</span>
  <span class="na">derive-schema</span><span class="pi">:</span> <span class="no">true</span></code></pre></figure>

  </div>
</div>

<p>The following table shows the mapping of JSON schema types to Flink SQL types:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">JSON schema</th>
      <th style="text-align: left">Flink SQL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">object</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ROW</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">boolean</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BOOLEAN</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">array</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ARRAY[_]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">number</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DECIMAL</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">integer</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DECIMAL</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">VARCHAR</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code> with <code class="highlighter-rouge">format: date-time</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">TIMESTAMP</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code> with <code class="highlighter-rouge">format: date</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DATE</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code> with <code class="highlighter-rouge">format: time</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">TIME</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code> with <code class="highlighter-rouge">encoding: base64</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ARRAY[TINYINT]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">null</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">NULL</code> (unsupported yet)</td>
    </tr>
  </tbody>
</table>

<p>Currently, Flink supports only a subset of the <a href="http://json-schema.org/">JSON schema specification</a> <code class="highlighter-rouge">draft-07</code>. Union types (as well as <code class="highlighter-rouge">allOf</code>, <code class="highlighter-rouge">anyOf</code>, <code class="highlighter-rouge">not</code>) are not supported yet. <code class="highlighter-rouge">oneOf</code> and arrays of types are only supported for specifying nullability.</p>

<p>Simple references that link to a common definition in the document are supported as shown in the more complex example below:</p>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="s2">"definitions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"street_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"state"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"street_address"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"city"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"state"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"billing_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/address"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"shipping_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/address"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"optional_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"oneOf"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"$ref"</span><span class="p">:</span><span class="w"> </span><span class="s2">"#/definitions/address"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p><strong>Missing Field Handling:</strong> By default, a missing JSON field is set to <code class="highlighter-rouge">null</code>. You can enable strict JSON parsing that will cancel the source (and query) if a field is missing.</p>

<p>Make sure to add the JSON format as a dependency.</p>

<h3 id="apache-avro-format">Apache Avro Format</h3>

<p><span class="label label-info">Format: Serialization Schema</span>
<span class="label label-info">Format: Deserialization Schema</span></p>

<p>The <a href="https://avro.apache.org/">Apache Avro</a> format allows to read and write Avro data that corresponds to a given format schema. The format schema can be defined either as a fully qualified class name of an Avro specific record or as an Avro schema string. If a class name is used, the class must be available in the classpath during runtime.</p>

<div class="codetabs">
  <div data-lang="Java/Scala">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="o">.</span><span class="na">withFormat</span><span class="o">(</span>
  <span class="k">new</span> <span class="nf">Avro</span><span class="o">()</span>

    <span class="c1">// required: define the schema either by using an Avro specific record class</span>
    <span class="o">.</span><span class="na">recordClass</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>

    <span class="c1">// or by using an Avro schema</span>
    <span class="o">.</span><span class="na">avroSchema</span><span class="o">(</span>
      <span class="s">"{"</span> <span class="o">+</span>
      <span class="s">"  \"type\": \"record\","</span> <span class="o">+</span>
      <span class="s">"  \"name\": \"test\","</span> <span class="o">+</span>
      <span class="s">"  \"fields\" : ["</span> <span class="o">+</span>
      <span class="s">"    {\"name\": \"a\", \"type\": \"long\"},"</span> <span class="o">+</span>
      <span class="s">"    {\"name\": \"b\", \"type\": \"string\"}"</span> <span class="o">+</span>
      <span class="s">"  ]"</span> <span class="o">+</span>
      <span class="s">"}"</span>
    <span class="o">)</span>
<span class="o">)</span></code></pre></figure>

  </div>

  <div data-lang="YAML">

    <figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">format</span><span class="pi">:</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">avro</span>

  <span class="c1"># required: define the schema either by using an Avro specific record class</span>
  <span class="na">record-class</span><span class="pi">:</span> <span class="s2">"</span><span class="s">org.organization.types.User"</span>

  <span class="c1"># or by using an Avro schema</span>
  <span class="na">avro-schema</span><span class="pi">:</span> <span class="pi">&gt;</span>
    <span class="no">{</span>
      <span class="no">"type": "record",</span>
      <span class="no">"name": "test",</span>
      <span class="no">"fields" : [</span>
        <span class="no">{"name": "a", "type": "long"},</span>
        <span class="no">{"name": "b", "type": "string"}</span>
      <span class="no">]</span>
    <span class="no">}</span></code></pre></figure>

  </div>
</div>

<p>Avro types are mapped to the corresponding SQL data types. Union types are only supported for specifying nullability otherwise they are converted to an <code class="highlighter-rouge">ANY</code> type. The following table shows the mapping:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Avro schema</th>
      <th style="text-align: left">Flink SQL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">record</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ROW</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">enum</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">VARCHAR</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">array</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ARRAY[_]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">map</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">MAP[VARCHAR, _]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">union</code></td>
      <td style="text-align: left">non-null type or <code class="highlighter-rouge">ANY</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">fixed</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ARRAY[TINYINT]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">string</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">VARCHAR</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">bytes</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">ARRAY[TINYINT]</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">int</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">INT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">long</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BIGINT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">float</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">FLOAT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">double</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DOUBLE</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">boolean</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BOOLEAN</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">int</code> with <code class="highlighter-rouge">logicalType: date</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DATE</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">int</code> with <code class="highlighter-rouge">logicalType: time-millis</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">TIME</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">int</code> with <code class="highlighter-rouge">logicalType: time-micros</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">INT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">long</code> with <code class="highlighter-rouge">logicalType: timestamp-millis</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">TIMESTAMP</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">long</code> with <code class="highlighter-rouge">logicalType: timestamp-micros</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">BIGINT</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">bytes</code> with <code class="highlighter-rouge">logicalType: decimal</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DECIMAL</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">fixed</code> with <code class="highlighter-rouge">logicalType: decimal</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">DECIMAL</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="highlighter-rouge">null</code></td>
      <td style="text-align: left"><code class="highlighter-rouge">NULL</code> (unsupported yet)</td>
    </tr>
  </tbody>
</table>

<p>Avro uses <a href="http://www.joda.org/joda-time/">Joda-Time</a> for representing logical date and time types in specific record classes. The Joda-Time dependency is not part of Flink’s distribution. Therefore, make sure that Joda-Time is in your classpath together with your specific record class during runtime. Avro formats specified via a schema string do not require Joda-Time to be present.</p>

<p>Make sure to add the Apache Avro dependency.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h2 id="further-tablesources-and-tablesinks">Further TableSources and TableSinks</h2>

<p>The following table sources and sinks have not yet been migrated (or have not been migrated entirely) to the new unified interfaces.</p>

<p>These are the additional <code class="highlighter-rouge">TableSource</code>s which are provided with Flink:</p>

<table>
  <tbody>
    <tr>
      <td><strong>Class name</strong></td>
      <td><strong>Maven dependency</strong></td>
      <td><strong>Batch?</strong></td>
      <td><strong>Streaming?</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">OrcTableSource</code></td>
      <td><code class="highlighter-rouge">flink-orc</code></td>
      <td>Y</td>
      <td>N</td>
      <td>A <code class="highlighter-rouge">TableSource</code> for ORC files.</td>
    </tr>
  </tbody>
</table>

<p>These are the additional <code class="highlighter-rouge">TableSink</code>s which are provided with Flink:</p>

<table>
  <tbody>
    <tr>
      <td><strong>Class name</strong></td>
      <td><strong>Maven dependency</strong></td>
      <td><strong>Batch?</strong></td>
      <td><strong>Streaming?</strong></td>
      <td><strong>Description</strong></td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">CsvTableSink</code></td>
      <td><code class="highlighter-rouge">flink-table</code></td>
      <td>Y</td>
      <td>Append</td>
      <td>A simple sink for CSV files.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">JDBCAppendTableSink</code></td>
      <td><code class="highlighter-rouge">flink-jdbc</code></td>
      <td>Y</td>
      <td>Append</td>
      <td>Writes a Table to a JDBC table.</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">CassandraAppendTableSink</code></td>
      <td><code class="highlighter-rouge">flink-connector-cassandra</code></td>
      <td>N</td>
      <td>Append</td>
      <td>Writes a Table to a Cassandra table.</td>
    </tr>
  </tbody>
</table>

<h3 id="orctablesource">OrcTableSource</h3>

<p>The <code class="highlighter-rouge">OrcTableSource</code> reads <a href="https://orc.apache.org">ORC files</a>. ORC is a file format for structured data and stores the data in a compressed, columnar representation. ORC is very storage efficient and supports projection and filter push-down.</p>

<p>An <code class="highlighter-rouge">OrcTableSource</code> is created as shown below:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">// create Hadoop Configuration</span>
<span class="n">配置</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">配置</span><span class="o">();</span>

<span class="n">OrcTableSource</span> <span class="n">orcTableSource</span> <span class="o">=</span> <span class="n">OrcTableSource</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="c1">// path to ORC file(s). NOTE: By default, directories are recursively scanned.</span>
  <span class="o">.</span><span class="na">path</span><span class="o">(</span><span class="s">"file:///path/to/data"</span><span class="o">)</span>
  <span class="c1">// schema of ORC files</span>
  <span class="o">.</span><span class="na">forOrcSchema</span><span class="o">(</span><span class="s">"struct&lt;name:string,addresses:array&lt;struct&lt;street:string,zip:smallint&gt;&gt;&gt;"</span><span class="o">)</span>
  <span class="c1">// Hadoop configuration</span>
  <span class="o">.</span><span class="na">withConfiguration</span><span class="o">(</span><span class="n">config</span><span class="o">)</span>
  <span class="c1">// build OrcTableSource</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// create Hadoop Configuration
</span><span class="k">val</span> <span class="n">config</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">配置</span><span class="o">()</span>

<span class="k">val</span> <span class="n">orcTableSource</span> <span class="k">=</span> <span class="nc">OrcTableSource</span><span class="o">.</span><span class="n">builder</span><span class="o">()</span>
  <span class="c1">// path to ORC file(s). NOTE: By default, directories are recursively scanned.
</span>  <span class="o">.</span><span class="n">path</span><span class="o">(</span><span class="s">"file:///path/to/data"</span><span class="o">)</span>
  <span class="c1">// schema of ORC files
</span>  <span class="o">.</span><span class="n">forOrcSchema</span><span class="o">(</span><span class="s">"struct&lt;name:string,addresses:array&lt;struct&lt;street:string,zip:smallint&gt;&gt;&gt;"</span><span class="o">)</span>
  <span class="c1">// Hadoop configuration
</span>  <span class="o">.</span><span class="n">withConfiguration</span><span class="o">(</span><span class="n">config</span><span class="o">)</span>
  <span class="c1">// build OrcTableSource
</span>  <span class="o">.</span><span class="n">build</span><span class="o">()</span></code></pre></figure>

  </div>
</div>

<p><strong>Note:</strong> The <code class="highlighter-rouge">OrcTableSource</code> does not support ORC’s <code class="highlighter-rouge">Union</code> type yet.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="csvtablesink">CsvTableSink</h3>

<p>The <code class="highlighter-rouge">CsvTableSink</code> emits a <code class="highlighter-rouge">Table</code> to one or more CSV files.</p>

<p>The sink only supports append-only streaming tables. It cannot be used to emit a <code class="highlighter-rouge">Table</code> that is continuously updated. See the <a href="./streaming/dynamic_tables.html#table-to-stream-conversion">documentation on Table to Stream conversions</a> for details. When emitting a streaming table, rows are written at least once (if checkpointing is enabled) and the <code class="highlighter-rouge">CsvTableSink</code> does not split output files into bucket files but continuously writes to the same files.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">CsvTableSink</span> <span class="n">sink</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CsvTableSink</span><span class="o">(</span>
    <span class="n">path</span><span class="o">,</span>                  <span class="c1">// output path</span>
    <span class="s">"|"</span><span class="o">,</span>                   <span class="c1">// optional: delimit files by '|'</span>
    <span class="mi">1</span><span class="o">,</span>                     <span class="c1">// optional: write to a single file</span>
    <span class="n">WriteMode</span><span class="o">.</span><span class="na">OVERWRITE</span><span class="o">);</span>  <span class="c1">// optional: override existing files</span>

<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSink</span><span class="o">(</span>
  <span class="s">"csvOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema</span>
  <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">"f0"</span><span class="o">,</span> <span class="s">"f1"</span><span class="o">},</span>
  <span class="k">new</span> <span class="n">TypeInformation</span><span class="o">[]{</span><span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">},</span>
  <span class="n">sink</span><span class="o">);</span>

<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">table</span><span class="o">.</span><span class="na">insertInto</span><span class="o">(</span><span class="s">"csvOutputTable"</span><span class="o">);</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">CsvTableSink</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CsvTableSink</span><span class="o">(</span>
    <span class="n">path</span><span class="o">,</span>                             <span class="c1">// output path
</span>    <span class="n">fieldDelim</span> <span class="k">=</span> <span class="s">"|"</span><span class="o">,</span>                 <span class="c1">// optional: delimit files by '|'
</span>    <span class="n">numFiles</span> <span class="k">=</span> <span class="mi">1</span><span class="o">,</span>                     <span class="c1">// optional: write to a single file
</span>    <span class="n">writeMode</span> <span class="k">=</span> <span class="nc">WriteMode</span><span class="o">.</span><span class="nc">OVERWRITE</span><span class="o">)</span>  <span class="c1">// optional: override existing files
</span>
<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSink</span><span class="o">(</span>
  <span class="s">"csvOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema
</span>  <span class="nc">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"f0"</span><span class="o">,</span> <span class="s">"f1"</span><span class="o">),</span>
  <span class="nc">Array</span><span class="o">[</span><span class="kt">TypeInformation</span><span class="o">[</span><span class="k">_</span><span class="o">]](</span><span class="nc">Types</span><span class="o">.</span><span class="nc">STRING</span><span class="o">,</span> <span class="nc">Types</span><span class="o">.</span><span class="nc">INT</span><span class="o">),</span>
  <span class="n">sink</span><span class="o">)</span>

<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">???</span>
<span class="n">table</span><span class="o">.</span><span class="n">insertInto</span><span class="o">(</span><span class="s">"csvOutputTable"</span><span class="o">)</span></code></pre></figure>

  </div>
</div>

<h3 id="jdbcappendtablesink">JDBCAppendTableSink</h3>

<p>The <code class="highlighter-rouge">JDBCAppendTableSink</code> emits a <code class="highlighter-rouge">Table</code> to a JDBC connection. The sink only supports append-only streaming tables. It cannot be used to emit a <code class="highlighter-rouge">Table</code> that is continuously updated. See the <a href="./streaming/dynamic_tables.html#table-to-stream-conversion">documentation on Table to Stream conversions</a> for details.</p>

<p>The <code class="highlighter-rouge">JDBCAppendTableSink</code> inserts each <code class="highlighter-rouge">Table</code> row at least once into the database table (if checkpointing is enabled). However, you can specify the insertion query using <code>REPLACE</code> or <code>INSERT OVERWRITE</code> to perform upsert writes to the database.</p>

<p>To use the JDBC sink, you have to add the JDBC connector dependency (<code>flink-jdbc</code>) to your project. Then you can create the sink using <code>JDBCAppendSinkBuilder</code>:</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">JDBCAppendTableSink</span> <span class="n">sink</span> <span class="o">=</span> <span class="n">JDBCAppendTableSink</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="na">setDrivername</span><span class="o">(</span><span class="s">"org.apache.derby.jdbc.EmbeddedDriver"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">setDBUrl</span><span class="o">(</span><span class="s">"jdbc:derby:memory:ebookshop"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">setQuery</span><span class="o">(</span><span class="s">"INSERT INTO books (id) VALUES (?)"</span><span class="o">)</span>
  <span class="o">.</span><span class="na">setParameterTypes</span><span class="o">(</span><span class="n">INT_TYPE_INFO</span><span class="o">)</span>
  <span class="o">.</span><span class="na">build</span><span class="o">();</span>

<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSink</span><span class="o">(</span>
  <span class="s">"jdbcOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema</span>
  <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">"id"</span><span class="o">},</span>
  <span class="k">new</span> <span class="n">TypeInformation</span><span class="o">[]{</span><span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">},</span>
  <span class="n">sink</span><span class="o">);</span>

<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">table</span><span class="o">.</span><span class="na">insertInto</span><span class="o">(</span><span class="s">"jdbcOutputTable"</span><span class="o">);</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">JDBCAppendTableSink</span> <span class="o">=</span> <span class="nc">JDBCAppendTableSink</span><span class="o">.</span><span class="n">builder</span><span class="o">()</span>
  <span class="o">.</span><span class="n">setDrivername</span><span class="o">(</span><span class="s">"org.apache.derby.jdbc.EmbeddedDriver"</span><span class="o">)</span>
  <span class="o">.</span><span class="n">setDBUrl</span><span class="o">(</span><span class="s">"jdbc:derby:memory:ebookshop"</span><span class="o">)</span>
  <span class="o">.</span><span class="n">setQuery</span><span class="o">(</span><span class="s">"INSERT INTO books (id) VALUES (?)"</span><span class="o">)</span>
  <span class="o">.</span><span class="n">setParameterTypes</span><span class="o">(</span><span class="nc">INT_TYPE_INFO</span><span class="o">)</span>
  <span class="o">.</span><span class="n">build</span><span class="o">()</span>

<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSink</span><span class="o">(</span>
  <span class="s">"jdbcOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema
</span>  <span class="nc">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"id"</span><span class="o">),</span>
  <span class="nc">Array</span><span class="o">[</span><span class="kt">TypeInformation</span><span class="o">[</span><span class="k">_</span><span class="o">]](</span><span class="nc">Types</span><span class="o">.</span><span class="nc">INT</span><span class="o">),</span>
  <span class="n">sink</span><span class="o">)</span>

<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">???</span>
<span class="n">table</span><span class="o">.</span><span class="n">insertInto</span><span class="o">(</span><span class="s">"jdbcOutputTable"</span><span class="o">)</span></code></pre></figure>

  </div>
</div>

<p>Similar to using <code>JDBCOutputFormat</code>, you have to explicitly specify the name of the JDBC driver, the JDBC URL, the query to be executed, and the field types of the JDBC table.</p>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>

<h3 id="cassandraappendtablesink">CassandraAppendTableSink</h3>

<p>The <code class="highlighter-rouge">CassandraAppendTableSink</code> emits a <code class="highlighter-rouge">Table</code> to a Cassandra table. The sink only supports append-only streaming tables. It cannot be used to emit a <code class="highlighter-rouge">Table</code> that is continuously updated. See the <a href="./streaming/dynamic_tables.html#table-to-stream-conversion">documentation on Table to Stream conversions</a> for details.</p>

<p>The <code class="highlighter-rouge">CassandraAppendTableSink</code> inserts all rows at least once into the Cassandra table if checkpointing is enabled. However, you can specify the query as upsert query.</p>

<p>To use the <code class="highlighter-rouge">CassandraAppendTableSink</code>, you have to add the Cassandra connector dependency (<code>flink-connector-cassandra</code>) to your project. The example below shows how to use the <code class="highlighter-rouge">CassandraAppendTableSink</code>.</p>

<div class="codetabs">
  <div data-lang="java">

    <figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ClusterBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// configure Cassandra cluster connection</span>

<span class="n">CassandraAppendTableSink</span> <span class="n">sink</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CassandraAppendTableSink</span><span class="o">(</span>
  <span class="n">builder</span><span class="o">,</span>
  <span class="c1">// the query must match the schema of the table</span>
  <span class="s">"INSERT INTO flink.myTable (id, name, value) VALUES (?, ?, ?)"</span><span class="o">);</span>

<span class="n">tableEnv</span><span class="o">.</span><span class="na">registerTableSink</span><span class="o">(</span>
  <span class="s">"cassandraOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema</span>
  <span class="k">new</span> <span class="n">String</span><span class="o">[]{</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"name"</span><span class="o">,</span> <span class="s">"value"</span><span class="o">},</span>
  <span class="k">new</span> <span class="n">TypeInformation</span><span class="o">[]{</span><span class="n">Types</span><span class="o">.</span><span class="na">INT</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">STRING</span><span class="o">,</span> <span class="n">Types</span><span class="o">.</span><span class="na">DOUBLE</span><span class="o">},</span>
  <span class="n">sink</span><span class="o">);</span>

<span class="n">Table</span> <span class="n">table</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">table</span><span class="o">.</span><span class="na">insertInto</span><span class="o">(</span><span class="n">cassandraOutputTable</span><span class="o">);</span></code></pre></figure>

  </div>

  <div data-lang="scala">

    <figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">builder</span><span class="k">:</span> <span class="kt">ClusterBuilder</span> <span class="o">=</span> <span class="o">...</span> <span class="c1">// configure Cassandra cluster connection
</span>
<span class="k">val</span> <span class="n">sink</span><span class="k">:</span> <span class="kt">CassandraAppendTableSink</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CassandraAppendTableSink</span><span class="o">(</span>
  <span class="n">builder</span><span class="o">,</span>
  <span class="c1">// the query must match the schema of the table
</span>  <span class="s">"INSERT INTO flink.myTable (id, name, value) VALUES (?, ?, ?)"</span><span class="o">)</span>

<span class="n">tableEnv</span><span class="o">.</span><span class="n">registerTableSink</span><span class="o">(</span>
  <span class="s">"cassandraOutputTable"</span><span class="o">,</span>
  <span class="c1">// specify table schema
</span>  <span class="nc">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">](</span><span class="s">"id"</span><span class="o">,</span> <span class="s">"name"</span><span class="o">,</span> <span class="s">"value"</span><span class="o">),</span>
  <span class="nc">Array</span><span class="o">[</span><span class="kt">TypeInformation</span><span class="o">[</span><span class="k">_</span><span class="o">]](</span><span class="nc">Types</span><span class="o">.</span><span class="nc">INT</span><span class="o">,</span> <span class="nc">Types</span><span class="o">.</span><span class="nc">STRING</span><span class="o">,</span> <span class="nc">Types</span><span class="o">.</span><span class="nc">DOUBLE</span><span class="o">),</span>
  <span class="n">sink</span><span class="o">)</span>

<span class="k">val</span> <span class="n">table</span><span class="k">:</span> <span class="kt">Table</span> <span class="o">=</span> <span class="o">???</span>
<span class="n">table</span><span class="o">.</span><span class="n">insertInto</span><span class="o">(</span><span class="n">cassandraOutputTable</span><span class="o">)</span></code></pre></figure>

  </div>
</div>

<p><a href="#top" class="top pull-right"><span class="glyphicon glyphicon-chevron-up"></span> Back to top</a></p>


        </div>
      </div>
    </div><!-- /.container -->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="//ci.apache.org/projects/flink/flink-docs-master/page/js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.0/anchor.min.js"></script>
    <script src="//ci.apache.org/projects/flink/flink-docs-master/page/js/flink.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-52545728-1', 'auto');
      ga('send', 'pageview');
    </script>

    <!-- Disqus -->
    
  </body>
</html>
